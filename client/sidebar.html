<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Leedz Invoicer</title>

  <link rel="stylesheet" href="css/globals.css" />
  <link rel="stylesheet" href="css/leedz_layout.css" />
 
  <!-- Load the main sidebar script -->
  <script type="module" src="js/sidebar.js"></script>

</head>


<body class="leedz-sidebar">

  <header class="leedz-header">
          <!-- Hamburger menu container with dropdown for page navigation -->
          <div class="hamburger-container">
              <img src="icons/hamburger.png" alt="Menu" class="leedz-hamburger"/>
              <!-- Dropdown menu - hidden by default, toggled by hamburger click -->
              <div class="hamburger-menu" style="display:none;">
                <div class="menu-item" data-page="startup">Startup</div>
              </div>
          </div>
          <!-- Logo container with app label that changes based on active page -->
          <div class="logo-container">
            <div class="app-label">app</div>
            <img src="icons/logo_black.png" alt="The Leedz" class="leedz-logo"/>
          </div>
  </header>


  <main class="leedz-form-section">

    <!-- ========================================== -->
    <!-- STARTUP PAGE (Configuration)              -->
    <!-- ========================================== -->
    <div id="page-startup" class="page-content">

      <div class="section-header">
        <label>Startup Settings</label>
      </div>

      <div id="display_win_startup" class="display-win">
        <table id="startup_table" class="booking-table">
          <thead>
            <tr>
              <th>Field</th>
              <th>Value</th>
            </tr>
          </thead>
          <tbody id="startup_tbody">
            <tr>
              <td>Server Host</td>
              <td><input type="text" id="startup-serverHost" class="table-input" placeholder="127.0.0.1" value="127.0.0.1" /></td>
            </tr>
            <tr>
              <td>Server Port</td>
              <td><input type="text" id="startup-serverPort" class="table-input" placeholder="3000" value="3000" /></td>
            </tr>
            <tr>
              <td>Database Name</td>
              <td><span id="startup-dbName" style="color: #666;">Not connected</span></td>
            </tr>
            <tr>
              <td>MCP Host</td>
              <td><input type="text" id="startup-mcpHost" class="table-input" placeholder="127.0.0.1" /></td>
            </tr>
            <tr>
              <td>MCP Port</td>
              <td><input type="text" id="startup-mcpPort" class="table-input" placeholder="3001" /></td>
            </tr>
          </tbody>
        </table>

        <!-- LLM Settings Collapsible Section -->
        <details id="llm-settings-details" style="margin-top: 20px;">
          <summary style="cursor: pointer; font-weight: bold; padding: 8px; background-color: #f0f0f0; border-radius: 4px;">
            LLM Settings
          </summary>
          <table id="llm_settings_table" class="booking-table" style="margin-top: 10px;">
            <tbody id="llm_settings_tbody">
              <tr>
                <td>API Key</td>
                <td><input type="password" id="startup-llmApiKey" class="table-input" placeholder="sk-ant-..." /></td>
              </tr>
              <tr>
                <td>Provider</td>
                <td><input type="text" id="startup-llmProvider" class="table-input" placeholder="claude-opus-4-1-20250805" /></td>
              </tr>
              <tr>
                <td>Base URL</td>
                <td><input type="text" id="startup-llmBaseUrl" class="table-input" placeholder="https://api.anthropic.com" /></td>
              </tr>
              <tr>
                <td>Anthropic Version</td>
                <td><input type="text" id="startup-llmAnthropicVersion" class="table-input" placeholder="2023-06-01" /></td>
              </tr>
              <tr>
                <td>Max Tokens</td>
                <td><input type="number" id="startup-llmMaxTokens" class="table-input" placeholder="1024" /></td>
              </tr>
            </tbody>
          </table>
        </details>
      </div>

    </div><!-- END page-startup -->

    <!-- ========================================== -->
    <!-- INVOICER PAGE (default/existing content)  -->
    <!-- ========================================== -->
    <div id="page-invoicer" class="page-content">

      <div class="section-header">
        <label for="display_win">Booking to Invoice</label>
        <div class="header-buttons">
          <button id="reloadBtn" class="reload-button" title="Reload the parser">
            <span>
              <img src="icons/arrows_white.png" class="button-icon" alt="reload parser"/>
            </span>
          </button>
          <button id="settingsBtn" class="settings-button" title="Open settings">
            <span>
              <img src="icons/settings.png" class="button-icon" alt="settings"/>
            </span>
          </button>
        </div>
      </div>
            <div id="display_win" class="display-win">
              <div id="loading_spinner" class="loading-spinner" style="display: none;">
                <img src="icons/wait_spinner.gif" alt="Loading..." />
                <span>Processing...</span>
              </div>
              <table id="booking_table" class="booking-table">
                <thead>
                  <tr>
                    <th>Field</th>
                    <th>Value</th>
                  </tr>
                </thead>
                <tbody id="booking_tbody">
                  <!-- Dynamic rows will be inserted here -->
                </tbody>
              </table>
            </div>

    </div><!-- END page-invoicer -->


    <!-- ========================================== -->
    <!-- GMAILER PAGE (Gmail sending configuration) -->
    <!-- ========================================== -->
    <div id="page-gmailer" class="page-content">

      <div class="section-header">
        <label>Authorize Gmail and Calendar</label>
      </div>

      <!-- Brief explanation of what this does -->
      <div class="mcp-explanation">
        Click the button below to authorize the MCP server to send emails using your account for one hour.
      </div>

      <!-- MCP server connection controls -->
      <div class="mcp-controls">
        <!-- MCP server host input (defaults to localhost) -->
        <label for="mcp-host">MCP Server Host:</label>
        <input type="text" id="mcp-host" placeholder="127.0.0.1" value="127.0.0.1"/>

        <!-- MCP server port input (defaults to 3001) -->
        <label for="mcp-port">MCP Server Port:</label>
        <input type="text" id="mcp-port" placeholder="3001" value="3001"/>

        <!-- Status display area for connection/auth status messages -->
        <div id="mcp-status">Initializing...</div>

        <!-- Button to trigger Gmail OAuth and send token to MCP server -->
        <!-- Token expires after 1 hour - user must re-enable -->
        <!-- Initially disabled until server health check passes -->
        <button id="enable-gmail-btn" class="sidebar-button" style="margin-top:20px;" disabled>
          Enable Gmail Sending (1 hour)
        </button>

        <!-- Refresh button to renew OAuth token without disabling -->
        <button id="refresh-gmail-btn" class="sidebar-button" style="margin-top:10px;" disabled>
          Refresh
        </button>
      </div>

    </div><!-- END page-gmailer -->


    <!-- ========================================== -->
    <!-- CLIENTS PAGE (Client capture)             -->
    <!-- ========================================== -->
    <div id="page-clients" class="page-content">

      <div class="section-header">
        <label for="display_win_clients">Client Capture</label>
        <div class="header-buttons">
          <button id="reloadBtnClients" class="reload-button" title="Reload the parser">
            <span>
              <img src="icons/arrows_white.png" class="button-icon" alt="reload parser"/>
            </span>
          </button>
          <button id="addClientBtnHeader" class="add-client-button" title="Add another client">+</button>
        </div>
      </div>

      <div id="display_win_clients" class="display-win">
        <div id="loading_spinner_clients" class="loading-spinner" style="display: none;">
          <img src="icons/wait_spinner.gif" alt="Loading..." />
          <span>Processing...</span>
        </div>
        <table id="client_table" class="booking-table">
          <thead>
            <tr>
              <th>Field</th>
              <th>Value</th>
            </tr>
          </thead>
          <tbody id="client_tbody">
            <!-- Dynamic rows will be inserted here -->
          </tbody>
        </table>
      </div>

    </div><!-- END page-clients -->


    <!-- ========================================== -->
    <!-- THANKYOU PAGE (Thank You Note Generator)  -->
    <!-- ========================================== -->
    <div id="page-thankyou" class="page-content">

      <div class="section-header">
        <label for="display_win_thankyou">Thank You Note</label>
        <div class="header-buttons">
          <button id="reloadBtnThankYou" class="reload-button" title="Reload the parser">
            <span>
              <img src="icons/arrows_white.png" class="button-icon" alt="reload parser"/>
            </span>
          </button>
          <button id="settingsBtnThankYou" class="settings-button" title="Open settings">
            <span>
              <img src="icons/settings.png" class="button-icon" alt="settings"/>
            </span>
          </button>
        </div>
      </div>

      <div id="display_win_thankyou" class="display-win">
        <div id="loading_spinner_thankyou" class="loading-spinner" style="display: none;">
          <img src="icons/wait_spinner.gif" alt="Loading..." />
          <span>Generating...</span>
        </div>
        <table id="thankyou_table" class="booking-table">
          <thead>
            <tr>
              <th>Field</th>
              <th>Value</th>
            </tr>
          </thead>
          <tbody id="thankyou_tbody">
            <!-- Dynamic rows will be inserted here -->
          </tbody>
        </table>

        <!-- Special Information Section -->
        <div id="special-info-section" class="special-info-section">
          <div class="special-info-label">
            Special Information
          </div>
          <textarea
            id="specialInfoTextarea"
            class="special-info-textarea"
            placeholder="Add personal notes, recollections, or special details to include in the thank you note..."
          ></textarea>
        </div>
      </div>

    </div><!-- END page-thankyou -->


    <!-- ========================================== -->
    <!-- RESPONDER PAGE (First Response Generator) -->
    <!-- ========================================== -->
    <div id="page-responder" class="page-content">

      <div class="section-header">
        <label for="display_win_responder">First Responder</label>
        <div class="header-buttons">
          <button id="reloadBtnResponder" class="reload-button" title="Reload the parser">
            <span>
              <img src="icons/arrows_white.png" class="button-icon" alt="reload parser"/>
            </span>
          </button>
          <button id="settingsBtnResponder" class="settings-button" title="Open settings">
            <span>
              <img src="icons/settings.png" class="button-icon" alt="settings"/>
            </span>
          </button>
        </div>
      </div>

      <div id="display_win_responder" class="display-win">
        <div id="loading_spinner_responder" class="loading-spinner" style="display: none;">
          <img src="icons/wait_spinner.gif" alt="Loading..." />
          <span>Generating...</span>
        </div>
        <table id="responder_table" class="booking-table">
          <thead>
            <tr>
              <th>Field</th>
              <th>Value</th>
            </tr>
          </thead>
          <tbody id="responder_tbody">
            <!-- Dynamic rows will be inserted here -->
          </tbody>
        </table>

        <!-- Special Information Section -->
        <div id="special-info-section-responder" class="special-info-section">
          <div class="special-info-label">
            Special Information (Deposit policy, fees, etc.)
          </div>
          <textarea
            id="specialInfoTextarea-responder"
            class="special-info-textarea"
            placeholder="Add deposit policy, additional fees, or special requirements to include in the response email..."
          ></textarea>
        </div>
      </div>

    </div><!-- END page-responder -->


    <!-- ========================================== -->
    <!-- OUTREACH PAGE (Outreach Email Generator)  -->
    <!-- ========================================== -->
    <div id="page-outreach" class="page-content">

      <div class="section-header">
        <label for="display_win_outreach">Outreach Generator</label>
        <div class="header-buttons">
          <button id="reloadBtnOutreach" class="reload-button" title="Reload the parser">
            <span>
              <img src="icons/arrows_white.png" class="button-icon" alt="reload parser"/>
            </span>
          </button>
          <button id="settingsBtnOutreach" class="settings-button" title="Open settings">
            <span>
              <img src="icons/settings.png" class="button-icon" alt="settings"/>
            </span>
          </button>
        </div>
      </div>

      <div id="display_win_outreach" class="display-win">
        <div id="loading_spinner_outreach" class="loading-spinner" style="display: none;">
          <img src="icons/wait_spinner.gif" alt="Loading..." />
          <span>Generating...</span>
        </div>
        <table id="outreach_table" class="booking-table">
          <thead>
            <tr>
              <th>Field</th>
              <th>Value</th>
            </tr>
          </thead>
          <tbody id="outreach_tbody">
            <!-- Dynamic rows will be inserted here -->
          </tbody>
        </table>

        <!-- Special Information Section -->
        <div id="special-info-section-outreach" class="special-info-section">
          <div class="special-info-label">
            Special Information
          </div>
          <textarea
            id="specialInfoTextarea-outreach"
            class="special-info-textarea"
            placeholder="Add details about services, rates, availability to include in outreach..."
          ></textarea>
        </div>
      </div>

    </div><!-- END page-outreach -->


  </main>

  <!-- STARTUP BUTTONS - Fixed position outside scrolling area, above footer -->
  <!-- Only visible when startup page is active -->
  <div class="button-wrapper" id="startup-buttons" style="display: none;">
    <button id="startupClearBtn" class="sidebar-button" title="Clear configuration">
      Clear
    </button>

    <button id="startupSaveBtn" class="sidebar-button" title="Save configuration">
      Save
    </button>
  </div>

  <!-- INVOICER BUTTONS - Fixed position outside scrolling area, above footer -->
  <!-- Only visible when invoicer page is active -->
  <div class="button-wrapper" id="invoicer-buttons" style="display: none;">
    <button id="cancelBtn" class="sidebar-button" title="Add booking to Google Calendar">
      Calendar
    </button>

    <button id="saveBtn" class="sidebar-button" title="Save to database">
      Save
    </button>

    <button id="pdfBtn" class="sidebar-button" title="Render PDF">
      PDF
    </button>
  </div>

  <!-- THANKYOU BUTTONS - Fixed position outside scrolling area, above footer -->
  <!-- Only visible when thankyou page is active -->
  <div class="button-wrapper" id="thankyou-buttons" style="display: none;">
    <button id="clearThankYouBtn" class="sidebar-button" title="Clear and reset">
      Clear
    </button>

    <button id="writeThankYouBtn" class="sidebar-button" title="Generate and send thank you">
      Write
    </button>
  </div>

  <!-- RESPONDER BUTTONS - Fixed position outside scrolling area, above footer -->
  <!-- Only visible when responder page is active -->
  <div class="button-wrapper" id="responder-buttons" style="display: none;">
    <button id="clearResponderBtn" class="sidebar-button" title="Clear and reset">
      Clear
    </button>

    <button id="saveResponderBtn" class="sidebar-button" title="Save client and booking to database">
      Save
    </button>

    <button id="writeResponderBtn" class="sidebar-button" title="Generate and send first response">
      Write
    </button>
  </div>

  <!-- OUTREACH BUTTONS - Fixed position outside scrolling area, above footer -->
  <!-- Only visible when outreach page is active -->
  <div class="button-wrapper" id="outreach-buttons" style="display: none;">
    <button id="clearOutreachBtn" class="sidebar-button" title="Clear and reset">
      Clear
    </button>

    <button id="writeOutreachBtn" class="sidebar-button" title="Generate and send outreach">
      Write
    </button>
  </div>

    <footer class="leedz-footer" id="footer">
      <img src="icons/grass.png" alt="grass" class="leedz-grass" id="grass-toggle"/>
    
      <!-- <div id="debug-output" class="debug-output"></div> -->

    
    </footer>
    

</body>
</html>